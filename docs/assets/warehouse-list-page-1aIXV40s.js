import{a as d,b as p,j as s,L as w,r as h}from"./index-au8Jr5Ol.js";import{u as f,c as v,f as j,a as b,L as N}from"./use-analitics-5mY6GBoN.js";import{s as y,f as H,L}from"./utils-s_3Q0h1X.js";const V="_row_1g1zy_1",z="_title__row_1g1zy_13",E="_car__number_1g1zy_29",T="_car__quantity_1g1zy_43",S="_gate__number_1g1zy_57",q="_highlighted_1g1zy_69",A="_gate__notAssigned_1g1zy_79",$="_tj__notAssigned_1g1zy_79",u={row:V,title__row:z,car__number:E,car__quantity:T,gate__number:S,highlighted:q,gate__notAssigned:A,tj__notAssigned:$},D=({carData:t})=>{const{searchValue:e}=d(p(r=>({searchValue:r.searchValue}))),{t:n,translation:a}=f(),o=y(t.carNumber,e);return s.jsx(s.Fragment,{children:s.jsx(w,{to:`/${t.carNumber.toLowerCase()}`,children:s.jsxs("div",{className:u.row,children:[s.jsxs("div",{className:u.car__number,children:[t.carsQuantity!==null&&s.jsx("span",{className:u.car__quantity,children:`${t.carsQuantity}.`}),o.map((r,l)=>s.jsxs(h.Fragment,{children:[l===1?s.jsx("span",{className:u.highlighted,children:e}):l>0&&e,r]},l))]}),t.gateName?s.jsxs("div",{className:u.gate__number,children:["â†’ ",t.gateName]}):s.jsx("div",{className:a!=="tj"?u.gate__notAssigned:u.tj__notAssigned,children:n("wait")})]},t.carsQuantity)})})},F=t=>{h.useEffect(()=>{if(t.current){const e=t.current,n=()=>{e&&(e.scrollHeight-e.scrollTop-e.clientHeight<=1&&(e.scrollTop-=2),e.scrollTop===0&&(e.scrollTop+=2))};return e&&e.addEventListener("scroll",n),()=>{e&&e.removeEventListener("scroll",n)}}},[t])},C=()=>{const{focus:t,blur:e,setBlur:n,setHeight:a,setTranslate:o}=d(p(r=>({focus:r.focus,blur:r.blur,setBlur:r.setBlur,setHeight:r.setHeight,setTranslate:r.setTranslate})));h.useEffect(()=>{let r=!1;const l=()=>{r||(r=!0,requestAnimationFrame(()=>{r=!1,window.visualViewport&&window.visualViewport.offsetTop>=0&&(e&&!t?(a("100%"),o(""),n(!1)):a(`${Math.max(0,window.visualViewport.height)}px`),scroll(0,0))}))};return window.visualViewport&&window.visualViewport.offsetTop>=0&&window.visualViewport.addEventListener("resize",l),()=>{window.visualViewport&&(window.visualViewport.removeEventListener("resize",l),a("100%"),o(""))}},[a,o,n,e,t])},k=()=>{const{focus:t}=d(p(e=>({focus:e.focus})));h.useEffect(()=>{var n,a;const e=o=>{o.preventDefault()};return t&&((n=document.querySelector("header"))==null||n.addEventListener("touchmove",e),(a=document.querySelector("#search"))==null||a.addEventListener("touchmove",e)),()=>{var o,r;(o=document.querySelector("header"))==null||o.removeEventListener("touchmove",e),(r=document.querySelector("#search"))==null||r.removeEventListener("touchmove",e)}},[t])},B="_content__wrapper_16vt5_1",R="_column__wrapper_16vt5_15",M="_column_16vt5_15",O="_row_16vt5_61",Q="_title__row_16vt5_71",P="_result__wrapper_16vt5_107",W="_one_16vt5_119",U="_result__btn_16vt5_143",i={content__wrapper:B,column__wrapper:R,column:M,row:O,title__row:Q,result__wrapper:P,one:W,result__btn:U},G=()=>{var g;const{t}=f(),e=h.useRef(null),{overflow:n,focus:a,houseData:o,searchValue:r,setOverflow:l}=d(p(c=>({houseData:c.houseData,searchValue:c.searchValue,focus:c.focus,overflow:c.overflow,setOverflow:c.setOverflow}))),_=H(o,r),x=(g=_[0])==null?void 0:g.carNumber.toLowerCase();return h.useEffect(()=>{l("hidden"),setTimeout(()=>{var c;l("auto"),e.current&&((c=e.current)==null||c.scrollTo({top:2}))},0)},[a,r,l]),F(e),C(),k(),s.jsx(s.Fragment,{children:s.jsx("div",{className:i.content__wrapper,children:s.jsx("div",{ref:e,style:{overflow:n},className:i.column__wrapper,children:s.jsxs("div",{onClick:c=>c.stopPropagation(),className:i.column,children:[s.jsxs("div",{className:v(i.title__row,i.row),children:[s.jsx("div",{children:t("table-number")}),s.jsx("div",{children:t("table-gates")})]}),_.map(c=>s.jsx(D,{carData:c},c.carNumber)),_.length===1?s.jsxs("div",{className:a?i.result__wrapper:v(i.result__wrapper,i.one),children:[s.jsx("button",{onMouseDown:c=>c.preventDefault(),className:i.result__btn,children:s.jsx(w,{to:`/${x}`,children:t("search-finded")})}),s.jsx("div",{children:t("search-not-finded")})]}):s.jsx("div",{children:t("search-not-finded")})]})})})})},I="_search__wrapper_7xzb7_1",J="_search__input_7xzb7_33",K="_highlighted_7xzb7_63",X="_search__info_7xzb7_71",m={search__wrapper:I,search__input:J,highlighted:K,search__info:X},Y=t=>{const{query:e}=t,{t:n}=f(),{searchValue:a,setSearchValue:o,focusHandler:r,blurHandler:l}=d(p(_=>({searchValue:_.searchValue,focusHandler:_.focusHandler,blurHandler:_.blurHandler,setSearchValue:_.setSearchValue})));return s.jsx(s.Fragment,{children:s.jsxs("div",{id:"search",className:m.search__wrapper,children:[s.jsx("input",{type:"number",placeholder:n("search-field"),inputMode:"numeric",pattern:"[0-9]*",className:m.search__input,value:a,onInput:o,onFocus:r,onBlur:l}),s.jsx("p",{className:m.search__info,children:n("search-notice")}),s.jsx(w,{className:m.search__link,to:`/${e==null?void 0:e.query}/schema`,children:n("search-question")})]})})},Z="_wrapper_veuw4_1",ee={wrapper:Z},oe=()=>{const{houseData:t,setHouseName:e,setHouseData:n,fetchHouseData:a}=d(p(r=>({houseData:r.houseData,setHouseName:r.setHouseName,setHouseData:r.setHouseData,fetchHouseData:r.fetchHouseData}))),o=j(t);return h.useEffect(()=>{o&&a(o),window.scrollTo({top:0})},[a,o,n,e]),b(),s.jsx(N,{children:t.length>0?s.jsxs("div",{className:ee.wrapper,children:[s.jsx(G,{}),s.jsx(Y,{query:o})]}):s.jsx(L,{})})};export{oe as default};
