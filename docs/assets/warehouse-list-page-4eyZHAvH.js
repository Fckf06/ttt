import{a as d,b as m,j as s,L as w,r as h,c as j,w as v}from"./index-Tar311uO.js";import{u as f,c as g,a as x,L as b}from"./use-analitics-m9PVfXFf.js";import{s as N,f as y,L as H}from"./utils-C_FUoIKH.js";const L="_content__wrapper_mgjkf_1",V="_column__wrapper_mgjkf_15",z="_column_mgjkf_15",k="_row_mgjkf_61",E="_title__row_mgjkf_71",S="_result__wrapper_mgjkf_107",T="_one_mgjkf_119",A="_result__btn_mgjkf_143",_={content__wrapper:L,column__wrapper:V,column:z,row:k,title__row:E,result__wrapper:S,one:T,result__btn:A},$="_row_1g1zy_1",D="_title__row_1g1zy_13",q="_car__number_1g1zy_29",F="_car__quantity_1g1zy_43",C="_gate__number_1g1zy_57",B="_highlighted_1g1zy_69",P="_gate__notAssigned_1g1zy_79",R="_tj__notAssigned_1g1zy_79",u={row:$,title__row:D,car__number:q,car__quantity:F,gate__number:C,highlighted:B,gate__notAssigned:P,tj__notAssigned:R},M=({carData:t})=>{const{searchValue:e}=d(m(n=>({searchValue:n.searchValue}))),{t:o,translation:c}=f(),a=N(t.carNumber,e);return s.jsx(s.Fragment,{children:s.jsx(w,{to:`/${t.carNumber.toLowerCase()}`,children:s.jsxs("div",{className:u.row,children:[s.jsxs("div",{className:u.car__number,children:[t.carsQuantity!==null&&s.jsx("span",{className:u.car__quantity,children:`${t.carsQuantity}.`}),a.map((n,r)=>s.jsxs(h.Fragment,{children:[r===1?s.jsx("span",{className:u.highlighted,children:e}):r>0&&e,n]},r))]}),t.gateName?s.jsxs("div",{className:u.gate__number,children:["â†’ ",t.gateName]}):s.jsx("div",{className:c!=="tj"?u.gate__notAssigned:u.tj__notAssigned,children:o("wait")})]},t.carsQuantity)})})},Q=t=>{h.useEffect(()=>{if(t.current){const e=t.current,o=()=>{e&&(e.scrollHeight-e.scrollTop-e.clientHeight<=1&&(e.scrollTop-=2),e.scrollTop===0&&(e.scrollTop+=2))};return e&&e.addEventListener("scroll",o),()=>{e&&e.removeEventListener("scroll",o)}}},[t])},W=()=>{const{focus:t,blur:e,setBlur:o,setHeight:c,setTranslate:a,setPosition:n}=d(m(r=>({focus:r.focus,blur:r.blur,setBlur:r.setBlur,setHeight:r.setHeight,setTranslate:r.setTranslate,setPosition:r.setPosition})));h.useEffect(()=>{let r=!1;const l=()=>{r||(r=!0,requestAnimationFrame(()=>{r=!1,window.visualViewport&&window.visualViewport.offsetTop>=0&&(e&&!t?(c("100%"),a(""),o(!1)):c(`${Math.max(0,window.visualViewport.height)}px`),scroll(0,0))}))};return window.visualViewport&&window.visualViewport.offsetTop>=0&&(window.visualViewport.addEventListener("resize",l),n("fixed")),()=>{window.visualViewport&&(window.visualViewport.removeEventListener("resize",l),c("100%"),n("static"),a(""))}},[c,a,o,e,t,n])},U=()=>{const{focus:t}=d(m(e=>({focus:e.focus})));h.useEffect(()=>{var o,c;const e=a=>{a.preventDefault()};return t&&((o=document.querySelector("header"))==null||o.addEventListener("touchmove",e),(c=document.querySelector("#search"))==null||c.addEventListener("touchmove",e)),()=>{var a,n;(a=document.querySelector("header"))==null||a.removeEventListener("touchmove",e),(n=document.querySelector("#search"))==null||n.removeEventListener("touchmove",e)}},[t])},G=()=>{var l;const{t}=f(),e=h.useRef(null),{focus:o,houseData:c,searchValue:a}=d(m(i=>({houseData:i.houseData,searchValue:i.searchValue,focus:i.focus}))),n=y(c,a),r=(l=n[0])==null?void 0:l.carNumber.toLowerCase();return h.useEffect(()=>{var i;e.current&&((i=e.current)==null||i.scrollTo({top:2}))},[a,o]),Q(e),W(),U(),s.jsx(s.Fragment,{children:s.jsx("div",{className:_.content__wrapper,children:s.jsx("div",{ref:e,className:_.column__wrapper,children:s.jsxs("div",{onClick:i=>i.stopPropagation(),className:_.column,children:[s.jsxs("div",{className:g(_.title__row,_.row),children:[s.jsx("div",{children:t("table-number")}),s.jsx("div",{children:t("table-gates")})]}),n.map(i=>s.jsx(M,{carData:i},i.carNumber)),n.length===1?s.jsxs("div",{className:o?_.result__wrapper:g(_.result__wrapper,_.one),children:[s.jsx("button",{onMouseDown:i=>i.preventDefault(),className:_.result__btn,children:s.jsx(w,{to:`/${r}`,children:t("search-finded")})}),s.jsx("div",{children:t("search-not-finded")})]}):s.jsx("div",{children:t("search-not-finded")})]})})})})},I="_search__wrapper_7xzb7_1",J="_search__input_7xzb7_33",K="_highlighted_7xzb7_63",O="_search__info_7xzb7_71",p={search__wrapper:I,search__input:J,highlighted:K,search__info:O},X=t=>{const{query:e}=t,{t:o}=f(),{searchValue:c,setSearchValue:a,focusHandler:n,blurHandler:r}=d(m(l=>({searchValue:l.searchValue,focusHandler:l.focusHandler,blurHandler:l.blurHandler,setSearchValue:l.setSearchValue})));return s.jsx(s.Fragment,{children:s.jsxs("div",{id:"search",className:p.search__wrapper,children:[s.jsx("input",{type:"number",placeholder:o("search-field"),inputMode:"numeric",pattern:"[0-9]*",className:p.search__input,value:c,onInput:a,onFocus:n,onBlur:r}),s.jsx("p",{className:p.search__info,children:o("search-notice")}),((e==null?void 0:e.query)==="kl"||(e==null?void 0:e.query)==="el"||(e==null?void 0:e.query)==="kz"||(e==null?void 0:e.query)==="nm")&&s.jsx(w,{className:p.search__link,to:`/${e==null?void 0:e.query}/schema`,children:o("search-question")})]})})},Y="_wrapper_veuw4_1",Z={wrapper:Y},re=()=>{const t=j(),{houseData:e,setHouseName:o,setHouseData:c,fetchHouseData:a}=d(m(r=>({houseData:r.houseData,setHouseName:r.setHouseName,setHouseData:r.setHouseData,fetchHouseData:r.fetchHouseData}))),n=v.find(r=>t.pathname.endsWith(r.query));return h.useEffect(()=>{n&&a(n),window.scrollTo({top:0})},[a,n,c,o]),x(),s.jsx(b,{children:e.length>0?s.jsxs("div",{className:Z.wrapper,children:[s.jsx(G,{}),s.jsx(X,{query:n})]}):s.jsx(H,{})})};export{re as default};
