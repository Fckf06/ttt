import{a as d,b as p,j as s,L as w,r as h,c as b,u as v,w as x}from"./index-szoSTa4C.js";import{u as g,c as f,a as j,L as N}from"./use-analitics-Hf0Mdv46.js";import{s as y,f as H,L}from"./utils-JO2fIqNK.js";const V="_content__wrapper_19pbq_1",q="_column__wrapper_19pbq_15",z="_column_19pbq_15",E="_row_19pbq_61",S="_title__row_19pbq_71",T="_result__wrapper_19pbq_107",$="_one_19pbq_119",A="_result__btn_19pbq_145",_={content__wrapper:V,column__wrapper:q,column:z,row:E,title__row:S,result__wrapper:T,one:$,result__btn:A},D="_row_1g1zy_1",k="_title__row_1g1zy_13",F="_car__number_1g1zy_29",C="_car__quantity_1g1zy_43",B="_gate__number_1g1zy_57",R="_highlighted_1g1zy_69",M="_gate__notAssigned_1g1zy_79",Q="_tj__notAssigned_1g1zy_79",u={row:D,title__row:k,car__number:F,car__quantity:C,gate__number:B,highlighted:R,gate__notAssigned:M,tj__notAssigned:Q},P=({carData:t})=>{const{searchValue:e}=d(p(r=>({searchValue:r.searchValue}))),{t:n,translation:c}=g(),o=y(t.carNumber,e);return s.jsx(s.Fragment,{children:s.jsx(w,{to:`/${t.carNumber.toLowerCase()}`,children:s.jsxs("div",{className:u.row,children:[s.jsxs("div",{className:u.car__number,children:[t.carsQuantity!==null&&s.jsx("span",{className:u.car__quantity,children:`${t.carsQuantity}.`}),o.map((r,a)=>s.jsxs(h.Fragment,{children:[a===1?s.jsx("span",{className:u.highlighted,children:e}):a>0&&e,r]},a))]}),t.gateName?s.jsxs("div",{className:u.gate__number,children:["â†’ ",t.gateName]}):s.jsx("div",{className:c!=="tj"?u.gate__notAssigned:u.tj__notAssigned,children:n("wait")})]},t.carsQuantity)})})},W=t=>{h.useEffect(()=>{if(t.current){const e=t.current,n=()=>{e&&(e.scrollHeight-e.scrollTop-e.clientHeight<=1&&(e.scrollTop-=2),e.scrollTop===0&&(e.scrollTop+=2))};return e&&e.addEventListener("scroll",n),()=>{e&&e.removeEventListener("scroll",n)}}},[t])},U=()=>{const{focus:t,blur:e,setBlur:n,setHeight:c,setTranslate:o}=d(p(r=>({focus:r.focus,blur:r.blur,setBlur:r.setBlur,setHeight:r.setHeight,setTranslate:r.setTranslate})));h.useEffect(()=>{let r=!1;const a=()=>{r||(r=!0,requestAnimationFrame(()=>{r=!1,window.visualViewport&&window.visualViewport.offsetTop>=0&&(e&&!t?(c("100%"),o(""),n(!1)):c(`${Math.max(0,window.visualViewport.height)}px`),scroll(0,0))}))};return window.visualViewport&&window.visualViewport.offsetTop>=0&&window.visualViewport.addEventListener("resize",a),()=>{window.visualViewport&&(window.visualViewport.removeEventListener("resize",a),c("100%"),o(""))}},[c,o,n,e,t])},G=()=>{const{focus:t}=d(p(e=>({focus:e.focus})));h.useEffect(()=>{var n,c;const e=o=>{o.preventDefault()};return t&&((n=document.querySelector("header"))==null||n.addEventListener("touchmove",e),(c=document.querySelector("#search"))==null||c.addEventListener("touchmove",e)),()=>{var o,r;(o=document.querySelector("header"))==null||o.removeEventListener("touchmove",e),(r=document.querySelector("#search"))==null||r.removeEventListener("touchmove",e)}},[t])},I=()=>{var l;const{t}=g(),e=h.useRef(null),{blur:n,houseData:c,searchValue:o}=d(p(i=>({houseData:i.houseData,searchValue:i.searchValue,blur:i.blur}))),r=H(c,o),a=(l=r[0])==null?void 0:l.carNumber.toLowerCase();return h.useEffect(()=>{var i;e.current&&((i=e.current)==null||i.scrollTo({top:2}))},[o,n]),W(e),U(),G(),console.log(n),s.jsx(s.Fragment,{children:s.jsx("div",{className:_.content__wrapper,children:s.jsx("div",{ref:e,className:_.column__wrapper,children:s.jsxs("div",{onClick:i=>i.stopPropagation(),className:_.column,children:[s.jsxs("div",{className:f(_.title__row,_.row),children:[s.jsx("div",{children:t("table-number")}),s.jsx("div",{children:t("table-gates")})]}),r.map(i=>s.jsx(P,{carData:i},i.carNumber)),r.length===1?s.jsxs("div",{className:n?f(_.result__wrapper,_.one):_.result__wrapper,children:[s.jsx("button",{onMouseDown:i=>i.preventDefault(),className:_.result__btn,children:s.jsx(w,{to:`/${a}`,children:t("search-finded")})}),s.jsx("div",{children:t("search-not-finded")})]}):s.jsx("div",{children:t("search-not-finded")})]})})})})},J="_search__wrapper_7xzb7_1",K="_search__input_7xzb7_33",O="_highlighted_7xzb7_63",X="_search__info_7xzb7_71",m={search__wrapper:J,search__input:K,highlighted:O,search__info:X},Y=t=>{const{query:e}=t,{t:n}=g(),{searchValue:c,setSearchValue:o,focusHandler:r,blurHandler:a}=d(p(l=>({searchValue:l.searchValue,focusHandler:l.focusHandler,blurHandler:l.blurHandler,setSearchValue:l.setSearchValue})));return s.jsx(s.Fragment,{children:s.jsxs("div",{id:"search",className:m.search__wrapper,children:[s.jsx("input",{type:"number",placeholder:n("search-field"),inputMode:"numeric",pattern:"[0-9]*",className:m.search__input,value:c,onInput:o,onFocus:r,onBlur:a}),s.jsx("p",{className:m.search__info,children:n("search-notice")}),((e==null?void 0:e.query)==="kl"||(e==null?void 0:e.query)==="el"||(e==null?void 0:e.query)==="kz"||(e==null?void 0:e.query)==="nm")&&s.jsx(w,{className:m.search__link,to:`/${e==null?void 0:e.query}/schema`,children:n("search-question")})]})})},Z="_wrapper_veuw4_1",ee={wrapper:Z},ne=()=>{const t=b(),e=v(),{houseData:n,setHouseName:c,setHouseData:o,fetchHouseData:r}=d(p(l=>({houseData:l.houseData,setHouseName:l.setHouseName,setHouseData:l.setHouseData,fetchHouseData:l.fetchHouseData}))),a=x.find(l=>t.pathname.endsWith(l.query));return h.useEffect(()=>{if(a)try{r(a)}catch{e(`/${a.query}`)}window.scrollTo({top:0})},[r,e,a,o,c]),j(),s.jsx(N,{children:n.length>0?s.jsxs("div",{className:ee.wrapper,children:[s.jsx(I,{}),s.jsx(Y,{query:a})]}):s.jsx(L,{})})};export{ne as default};
