import{a as d,b as p,j as s,L as w,r as h,c as N,w as V}from"./index-y-Hh6oVj.js";import{u as f,c as b,a as y,L as H}from"./use-analitics-HoXIVnfU.js";import{s as L,f as z,L as T}from"./utils-L6W1WG2C.js";const k="_content__wrapper_mgjkf_1",E="_column__wrapper_mgjkf_15",S="_column_mgjkf_15",A="_row_mgjkf_61",$="_title__row_mgjkf_71",D="_result__wrapper_mgjkf_107",q="_one_mgjkf_119",F="_result__btn_mgjkf_143",l={content__wrapper:k,column__wrapper:E,column:S,row:A,title__row:$,result__wrapper:D,one:q,result__btn:F},C="_row_1g1zy_1",B="_title__row_1g1zy_13",R="_car__number_1g1zy_29",M="_car__quantity_1g1zy_43",Q="_gate__number_1g1zy_57",P="_highlighted_1g1zy_69",W="_gate__notAssigned_1g1zy_79",U="_tj__notAssigned_1g1zy_79",u={row:C,title__row:B,car__number:R,car__quantity:M,gate__number:Q,highlighted:P,gate__notAssigned:W,tj__notAssigned:U},G=({carData:t})=>{const{searchValue:e}=d(p(r=>({searchValue:r.searchValue}))),{t:o,translation:c}=f(),n=L(t.carNumber,e);return s.jsx(s.Fragment,{children:s.jsx(w,{to:`/${t.carNumber.toLowerCase()}`,children:s.jsxs("div",{className:u.row,children:[s.jsxs("div",{className:u.car__number,children:[t.carsQuantity!==null&&s.jsx("span",{className:u.car__quantity,children:`${t.carsQuantity}.`}),n.map((r,a)=>s.jsxs(h.Fragment,{children:[a===1?s.jsx("span",{className:u.highlighted,children:e}):a>0&&e,r]},a))]}),t.gateName?s.jsxs("div",{className:u.gate__number,children:["â†’ ",t.gateName]}):s.jsx("div",{className:c!=="tj"?u.gate__notAssigned:u.tj__notAssigned,children:o("wait")})]},t.carsQuantity)})})},I=t=>{h.useEffect(()=>{if(t.current){const e=t.current,o=()=>{e&&(e.scrollHeight-e.scrollTop-e.clientHeight<=1&&(e.scrollTop-=2),e.scrollTop===0&&(e.scrollTop+=2))};return e&&e.addEventListener("scroll",o),()=>{e&&e.removeEventListener("scroll",o)}}},[t])},J=()=>{const{focus:t,blur:e,setBlur:o,setHeight:c,setTranslate:n}=d(p(r=>({focus:r.focus,blur:r.blur,setBlur:r.setBlur,setHeight:r.setHeight,setTranslate:r.setTranslate})));h.useEffect(()=>{let r=!1;const a=()=>{r||(r=!0,requestAnimationFrame(()=>{r=!1,window.visualViewport&&window.visualViewport.offsetTop>=0&&(e&&!t?(c("100%"),n(""),o(!1)):c(`${Math.max(0,window.visualViewport.height)}px`),scroll(0,0))}))};return window.visualViewport&&window.visualViewport.offsetTop>=0&&window.visualViewport.addEventListener("resize",a),()=>{window.visualViewport&&(window.visualViewport.removeEventListener("resize",a),c("100%"),n(""))}},[c,n,o,e,t])},K=()=>{const{focus:t}=d(p(e=>({focus:e.focus})));h.useEffect(()=>{var o,c;const e=n=>{n.preventDefault()};return t&&((o=document.querySelector("header"))==null||o.addEventListener("touchmove",e),(c=document.querySelector("#search"))==null||c.addEventListener("touchmove",e)),()=>{var n,r;(n=document.querySelector("header"))==null||n.removeEventListener("touchmove",e),(r=document.querySelector("#search"))==null||r.removeEventListener("touchmove",e)}},[t])},O=()=>{var _;const{t}=f(),e=h.useRef(null),{focus:o,houseData:c,searchValue:n}=d(p(i=>({houseData:i.houseData,searchValue:i.searchValue,focus:i.focus}))),r=z(c,n),a=(_=r[0])==null?void 0:_.carNumber.toLowerCase();return h.useEffect(()=>{var i,g,v,j,x;e.current&&((j=e.current)==null||j.scrollTo({top:(i=window.visualViewport)!=null&&i.offsetTop?((g=window.visualViewport)==null?void 0:g.offsetTop)+2:(v=window.visualViewport)==null?void 0:v.offsetTop})),console.log((x=window.visualViewport)==null?void 0:x.offsetTop)},[n]),I(e),J(),K(),s.jsx(s.Fragment,{children:s.jsx("div",{className:l.content__wrapper,children:s.jsx("div",{className:l.column__wrapper,children:s.jsxs("div",{ref:e,onClick:i=>i.stopPropagation(),className:l.column,children:[s.jsxs("div",{className:b(l.title__row,l.row),children:[s.jsx("div",{children:t("table-number")}),s.jsx("div",{children:t("table-gates")})]}),r.map(i=>s.jsx(G,{carData:i},i.carNumber)),r.length===1?s.jsxs("div",{className:o?l.result__wrapper:b(l.result__wrapper,l.one),children:[s.jsx("button",{onMouseDown:i=>i.preventDefault(),className:l.result__btn,children:s.jsx(w,{to:`/${a}`,children:t("search-finded")})}),s.jsx("div",{children:t("search-not-finded")})]}):s.jsx("div",{children:t("search-not-finded")})]})})})})},X="_search__wrapper_7xzb7_1",Y="_search__input_7xzb7_33",Z="_highlighted_7xzb7_63",ee="_search__info_7xzb7_71",m={search__wrapper:X,search__input:Y,highlighted:Z,search__info:ee},se=t=>{const{query:e}=t,{t:o}=f(),{searchValue:c,setSearchValue:n,focusHandler:r,blurHandler:a}=d(p(_=>({searchValue:_.searchValue,focusHandler:_.focusHandler,blurHandler:_.blurHandler,setSearchValue:_.setSearchValue})));return s.jsx(s.Fragment,{children:s.jsxs("div",{id:"search",className:m.search__wrapper,children:[s.jsx("input",{type:"number",placeholder:o("search-field"),inputMode:"numeric",pattern:"[0-9]*",className:m.search__input,value:c,onInput:n,onFocus:r,onBlur:a}),s.jsx("p",{className:m.search__info,children:o("search-notice")}),((e==null?void 0:e.query)==="kl"||(e==null?void 0:e.query)==="el"||(e==null?void 0:e.query)==="kz"||(e==null?void 0:e.query)==="nm")&&s.jsx(w,{className:m.search__link,to:`/${e==null?void 0:e.query}/schema`,children:o("search-question")})]})})},te="_wrapper_veuw4_1",re={wrapper:te},ce=()=>{const t=N(),{houseData:e,setHouseName:o,setHouseData:c,fetchHouseData:n}=d(p(a=>({houseData:a.houseData,setHouseName:a.setHouseName,setHouseData:a.setHouseData,fetchHouseData:a.fetchHouseData}))),r=V.find(a=>t.pathname.endsWith(a.query));return h.useEffect(()=>{r&&n(r),window.scrollTo({top:0})},[n,r,c,o]),y(),s.jsx(H,{children:e.length>0?s.jsxs("div",{className:re.wrapper,children:[s.jsx(O,{}),s.jsx(se,{query:r})]}):s.jsx(T,{})})};export{ce as default};
